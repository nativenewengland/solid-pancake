<!DOCTYPE html>
<html lang="en" style="height: 100%;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indigenous History Map</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IM+Fell+DW+Pica:ital@0;1&display=swap">
    <link rel="stylesheet" href="css/leaflet.css">
    <link rel="stylesheet" href="css/index.css">
    <script src="js/leaflet.js"></script>
     
</head>
<body>
    <!-- <h1>map</h1> -->

    <div id="map"></div>
    <aside id="wiki-info" class="wiki-info" aria-expanded="true">
        <div class="wiki-info__content">
            <div id="wiki-info-default" class="wiki-info__default">
                <h2 class="wiki-info__title">Project Overview</h2>
                <p class="wiki-info__intro">
                    To those who dwell below the clouds yet beyond the mountains, the breadth of Dwarfdom is whispered as
                    a distant wonder of hearthfire, hammer-song, and stone that remembers every oath ever sworn. This atlas
                    serves as a primer to that realm. Each marker is a doorway into a stronghold hollowed from the heart of
                    a peak, a ledger of the clans that share its forges, and a chronicle of the tunnels that lash the Holds
                    together beneath the world.
                </p>
                <p>
                    Dwarfen civilization is rooted in fortress settlements known simply as Holds. What began as the fortified
                    manors of gold-rich families grew over the millennia into labyrinthine cities whose vaulted halls plunge
                    deep into the bedrock. Within these sanctuaries, guilds of miners, smiths, engineers, and loremenders work
                    in concert: some map veins of silver, mithril, and gemstones; others tend to the resonant machinery that
                    keeps the underways safe; scribes and elders etch clan histories into runic stone so the memory of each
                    triumph and tragedy cannot be weathered away. Visitors from the surface rarely see more than the trade
                    antechambers, but beneath them lie miles of chambers arranged in rings of defense, punctuated by storied
                    breweries, revered tomb-colleges, and mustering grounds ready to rouse a shieldwall at a moment’s notice.
                </p>
                <p>
                    In the age of myth every Hold ruled broad fiefdoms, patrolling passes and highland valleys in vigilant
                    rotations. The collapse of ancient alliances, coupled with encroaching threats in the deep, fractured that
                    web of security. Some settlements were abandoned to cave-ins or plague, others besieged until their final
                    beacon went dark. What remains is a constellation of resilient enclaves separated by stretches of perilous
                    wild, each one the steward of traditions stretching back to the world’s dawn. This map does not shy away
                    from those losses: markers for ruined citadels are preserved alongside the thriving Holds to show the slow
                    ebb of dwarven dominion and the sparks of resurgence where new lords are reforging what was broken.
                </p>
                <p>
                    Treat this overview as both guide and invitation. Follow the ridgelines to discover how each Hold shields
                    the ore-veins it claims, compare the guild banners that still flutter above the gates, and linger over the
                    footnotes describing wars waged in tunnels no sunlight has ever reached. Should you possess tales of a
                    forgotten redoubt or the rediscovery of a lost vault, add your lore so the ledger of the Holds remains
                    unbroken for the next generation of wayfarers, scholars, and oath-kin.
                </p>
                <dl class="wiki-info__details">
                    <div>
                        <dt>Focus</dt>
                        <dd>Mountain Holds, fallen strongholds, rekindled enclaves, and the routes that bind them.</dd>
                    </div>
                    <div>
                        <dt>Sources</dt>
                        <dd>Guild ledgers, clan chronicles, miners’ tallies of ore-veins, and salvaged watch-rune reports.</dd>
                    </div>
                    <div>
                        <dt>Navigation Tips</dt>
                        <dd>Trace the ridgelines to find ancestral vaults, delve into marker stories for the fate of each Hold, and compare neighboring enclaves to glimpse the ebb and return of dwarven dominion.</dd>
                    </div>
                </dl>
                <p class="wiki-info__footer">Share tidings from your own halls so the ledger of the Holds may never fall silent.</p>
            </div>
            <div id="wiki-marker-info" class="wiki-info__marker hidden" aria-live="polite">
                <div
                    id="wiki-marker-infobox"
                    class="wiki-infobox hidden"
                    aria-label="Marker infobox"
                ></div>
                <h2 id="wiki-marker-title" class="wiki-info__title"></h2>
                <p id="wiki-marker-alt-names" class="wiki-info__alt hidden"></p>
                <h3 id="wiki-marker-subheader" class="wiki-info__subheader hidden"></h3>
                <div id="wiki-marker-description" class="wiki-info__description"></div>
            </div>
        </div>
        <button
            id="wiki-info-toggle"
            class="wiki-info__toggle"
            type="button"
            aria-label="Collapse information panel"
            aria-expanded="true"
        ></button>
    </aside>
    <button id="save-changes">Save Changes</button>
    <div id="icon-size-control" role="group" aria-labelledby="icon-size-label">
        <div class="icon-size-control__header">
            <label for="icon-size-slider" id="icon-size-label">Icon Size</label>
            <span id="icon-size-value" aria-live="polite">100%</span>
        </div>
        <input
            type="range"
            id="icon-size-slider"
            min="1"
            max="200"
            step="1"
            value="100"
            aria-labelledby="icon-size-label"
        >
    </div>
    <button
        id="credits-toggle"
        class="floating-button"
        type="button"
        aria-haspopup="dialog"
        aria-controls="credits-panel"
        aria-expanded="false"
    >
        Credits
    </button>
    <div id="mouse-coords"></div>
    <div id="info-panel" class="hidden">
        <button id="close-info" class="close-button">&times;</button>
        <div
            id="info-infobox"
            class="wiki-infobox hidden"
            aria-label="Marker infobox"
        ></div>
        <h2 id="info-title"></h2>
        <p id="info-alt-names" class="info-alt-names hidden"></p>
        <h3 id="info-subheader" class="info-subheader hidden"></h3>
        <div id="info-description"></div>
    </div>
    <div id="credits-panel" class="hidden" aria-hidden="true">
        <div
            class="credits-content"
            role="dialog"
            aria-modal="true"
            aria-labelledby="credits-title"
            tabindex="-1"
        >
            <button id="close-credits" class="close-button" aria-label="Close credits">&times;</button>
            <h2 id="credits-title">Credits</h2>
            <p>
                This Map was the end result of over 2,000 hours of research done to make knowledge about the pre-colonized landscape of the region more accessible.
            </p>
            <ul>
                <li><strong>Special Thanks to those who went above and beyond to assist with this project:</strong> Prof. Thomas Doughton, </li>
                <li><strong>Credit to those who assisted:</strong> Adapted from 17th century map sources in the public domain</li>
                <li><strong>No acknowledgment to those who ignored repeated requests for assistance:</strong> Prof. Lisa Brooks,</li>
                <li><strong>No thanks to those who were hostile towards the project or went out of their way to hinder the research efforts:</strong> Community contributors and maintainers</li>
            </ul>
            <p>
                We are grateful to the many Indigenous scholars, culture bearers, and archivists whose work informs this project.
            </p>
        </div>
    </div>
    <div id="marker-form-overlay" class="hidden">
        <div id="marker-form">
            <h3>Add Marker</h3>
            <label>Name:
                <input type="text" id="marker-name">
            </label>
            <label>Alternative Names:
                <input type="text" id="marker-alt-names">
            </label>
            <label>Subheader:
                <input type="text" id="marker-subheader">
            </label>
            <label>Description:
                <small>Supports Markdown (e.g., <code>**bold**</code>, <code>![alt](url)</code> for images) and footnotes (pair <code>[^1]</code> with <code>[^1]: Source details</code>).</small>
                <div class="markdown-image-tools">
                    <button type="button" class="markdown-image-button" data-target="marker-description">Insert image reference</button>
                    <input type="file" accept="image/*" class="markdown-image-input" data-target="marker-description" aria-label="Choose an image to insert into the description">
                </div>
                <textarea id="marker-description"></textarea>
            </label>
            <label for="marker-infobox">Infobox Data:
                <small>Provide JSON describing the infobox (e.g., <code>{"title":"Profile","rows":[{"label":"Habitat","value":"Tidal bog"}]}</code>).</small>
            </label>
            <textarea id="marker-infobox" class="marker-infobox-input"></textarea>
            <label>Icon:
                <select id="marker-icon"></select>
            </label>
            <button id="marker-save">Save</button>
            <button id="marker-cancel">Cancel</button>
            <button id="marker-convert" class="hidden">Convert to Text</button>
        </div>
    </div>
    <div id="polygon-form-overlay" class="hidden">
        <div id="polygon-form">
            <h3>Add Polygon</h3>
            <label>Name:
                <input type="text" id="polygon-name">
            </label>
            <label>Description:
                <small>Supports Markdown (e.g., <code>**bold**</code>, <code>![alt](url)</code> for images) and footnotes (pair <code>[^1]</code> with <code>[^1]: Source details</code>).</small>
                <div class="markdown-image-tools">
                    <button type="button" class="markdown-image-button" data-target="polygon-description">Insert image reference</button>
                    <input type="file" accept="image/*" class="markdown-image-input" data-target="polygon-description" aria-label="Choose an image to insert into the description">
                </div>
                <textarea id="polygon-description"></textarea>
            </label>
            <label>Color:
                <input type="color" id="polygon-color" value="#3388ff">
            </label>
            <button id="polygon-save">Save</button>
            <button id="polygon-cancel">Cancel</button>
        </div>
    </div>
    <div id="text-form-overlay" class="hidden">
        <div id="text-form">
            <h3>Add Text</h3>
            <label>Text:
                <input type="text" id="text-label-text">
            </label>
            <label>Alternative Names:
                <input type="text" id="text-label-alt-names">
            </label>
            <label>Subheader:
                <input type="text" id="text-label-subheader">
            </label>
            <label>Description:
                <small>Supports Markdown (e.g., <code>**bold**</code>, <code>![alt](url)</code> for images) and footnotes (pair <code>[^1]</code> with <code>[^1]: Source details</code>).</small>
                <div class="markdown-image-tools">
                    <button type="button" class="markdown-image-button" data-target="text-label-description">Insert image reference</button>
                    <input type="file" accept="image/*" class="markdown-image-input" data-target="text-label-description" aria-label="Choose an image to insert into the description">
                </div>
                <textarea id="text-label-description"></textarea>
            </label>
            <label>Size:
                <input type="number" id="text-label-size" value="14">
            </label>
            <label>Angle:
                <input type="number" id="text-label-angle" value="0">
            </label>
            <label>Letter Spacing:
                <input type="range" id="text-letter-spacing" min="-5" max="20" value="0">
            </label>
            <label>Curve Radius:
                <input type="number" id="text-curve-radius" value="0">
            </label>
            <button id="text-save">Save</button>
            <button id="text-cancel">Cancel</button>
            <button id="text-convert" class="hidden">Convert to Marker</button>
        </div>
    </div>
    <div
        id="image-lightbox"
        class="image-lightbox hidden"
        role="dialog"
        aria-modal="true"
        aria-labelledby="image-lightbox-caption"
        aria-hidden="true"
    >
        <div class="image-lightbox__inner">
            <button
                id="image-lightbox-close"
                class="image-lightbox__close"
                type="button"
                aria-label="Close expanded image"
            >
                ⤫
            </button>
            <img id="image-lightbox-image" class="image-lightbox__image" alt="">
            <p id="image-lightbox-caption" class="image-lightbox__caption hidden"></p>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
    <script src="js/map.js"></script>
</body>
</html>


